<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Numerical Examples
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Purely functional random number generating framework designed for F#">
    <meta name="author" content="RecycleBin">

    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="http://kos59125.github.io/FsRandom/content/style.css" />
    <script type="text/javascript" src="http://kos59125.github.io/FsRandom/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <h3 class="muted"><a href="http://kos59125.github.io/FsRandom">FsRandom</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<a name="numerical-examples"></a>

<h1>Numerical Examples</h1>

<p>This page illustrates how FsRandom is applicable to scientific computations.
For statistics, the Statistics module is useful:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">FsRandom</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Statistics</span></pre>
</td>
</tr>
</table>

<a name="monte-carlo"></a>

<h2>Estimating pi, the ratio of a circle's circumference to its diameter</h2>

<p>Suppose there is a circle of radius 1 is inside a square with side length 2.
The area of the circle is \(\pi\) and the area of the square is 4.
If you put \(N\) random points on the square, roughly \(\displaystyle\frac{\pi}{4}N\) points are inside the circle.
In other words, if you find \(M\) points out of \(N\) are inside the circle,
\(\displaystyle\frac{M}{N}\) approximates \(\displaystyle\frac{\pi}{4}\).</p>

<div style="text-align:center;margin-right:100px;">
<img src="images/monte-carlo-pi.png" width="512" height="512" alt="random points approximates pi" />
</div>

<p>Random points can be described simply and easily as follows:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">randomPointGenerator</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">random</span> {
   <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">uniform</span> (<span class="o">-</span><span class="n">1.0</span>, <span class="n">1.0</span>)
   <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">y</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="i">uniform</span> (<span class="o">-</span><span class="n">1.0</span>, <span class="n">1.0</span>)
   <span class="k">return</span> (<span onmouseout="hideTip(event, 'fs5', 9)" onmouseover="showTip(event, 'fs5', 9)" class="i">x</span>, <span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="i">y</span>)
}</pre>
</td>
</tr>
</table>

<p>To give each point weight 4 if the point is inside the circle and 0 otherwise
adjusts the average of total score to become \(\pi\).</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="i">weight</span> (<span onmouseout="hideTip(event, 'fs5', 12)" onmouseover="showTip(event, 'fs5', 12)" class="i">x</span>, <span onmouseout="hideTip(event, 'fs7', 13)" onmouseover="showTip(event, 'fs7', 13)" class="i">y</span>) <span class="o">=</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs5', 14)" onmouseover="showTip(event, 'fs5', 14)" class="i">x</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs5', 15)" onmouseover="showTip(event, 'fs5', 15)" class="i">x</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs7', 16)" onmouseover="showTip(event, 'fs7', 16)" class="i">y</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs7', 17)" onmouseover="showTip(event, 'fs7', 17)" class="i">y</span> <span class="o">&lt;=</span> <span class="n">1.0</span> <span class="k">then</span> <span class="n">4.0</span> <span class="k">else</span> <span class="n">0.0</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 18)" onmouseover="showTip(event, 'fs9', 18)" class="i">randomScoreGenerator</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 19)" onmouseover="showTip(event, 'fs10', 19)" class="i">Random</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="i">map</span> <span onmouseout="hideTip(event, 'fs8', 21)" onmouseover="showTip(event, 'fs8', 21)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs3', 22)" onmouseover="showTip(event, 'fs3', 22)" class="i">randomPointGenerator</span></pre>
</td>
</tr>
</table>

<p>The average of the random scores approximates \(\pi\).
To generate 1,000,000 scores and to compute the approximation:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span onmouseout="hideTip(event, 'fs12', 23)" onmouseover="showTip(event, 'fs12', 23)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="i">ofRandom</span> <span onmouseout="hideTip(event, 'fs9', 25)" onmouseover="showTip(event, 'fs9', 25)" class="i">randomScoreGenerator</span> <span onmouseout="hideTip(event, 'fs14', 26)" onmouseover="showTip(event, 'fs14', 26)" class="i">state</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs12', 27)" onmouseover="showTip(event, 'fs12', 27)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 28)" onmouseover="showTip(event, 'fs15', 28)" class="i">take</span> <span class="n">1000000</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs12', 29)" onmouseover="showTip(event, 'fs12', 29)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 30)" onmouseover="showTip(event, 'fs16', 30)" class="i">average</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 31)" onmouseover="showTip(event, 'fs17', 31)" class="i">printf</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">f</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<pre><code>3.140812
</code></pre>

<a name="gibbs-sampler"></a>

<h2>Generating bivariate normal random numbers using Gibbs sampler</h2>

<p>To sample from bivariate normal distribution
\(\displaystyle N_{2}\left(
\left[\begin{array}{c}
  \mu_{X} \\
  \mu_{Y}
\end{array}\right],
\left[\begin{array}{cc}
  \sigma_{X}^{2} &amp; \sigma_{XY} \\
  \sigma_{XY} &amp; \sigma_{Y}^{2}
\end{array}\right]
\right) \),
you will construct a Gibbs sampler.
Let \(f_{2}(x, y)\) be the density function of \(N_{2}\),
and let \(x'\) and \(y'\) be \(x-\mu_{X}\) and \(y-\mu_{Y}\) respectively.
Then,
<span class="math">\(\)</span>
\begin{eqnarray}
f_{2}(x, y) &amp; \propto &amp; \exp\left(
-\frac{1}{2}\left[\begin{array}{c}
x' \\
y'
\end{array}\right]^{T}
\left[\begin{array}{cc}
  \sigma_{X}^{2} &amp; \sigma_{XY} \\
  \sigma_{XY} &amp; \sigma_{Y}^{2}
\end{array}\right]^{-1}
\left[\begin{array}{c}
x' \\
y'
\end{array}\right]
\right) \\
&amp; \propto &amp; \exp\left(
-\frac{\left(x'-\sigma_{XY}y'/\sigma_{Y}^{2}\right)^{2}}{2\left(\sigma_{X}^{2}-\sigma_{XY}^{2}/\sigma_{Y}^{2}\right)}
\right)
\end{eqnarray}
<span class="math">\(\)</span>
This means the conditional probability of \(x\) given \(y\) is distributed normally,
and its mean is \(\displaystyle \mu_{X}+\frac{\sigma_{XY}}{\sigma_{Y}^{2}}\left(y-\mu_{Y}\right)\)
and its variance is \(\displaystyle \sigma_{X}^{2}-\frac{\sigma_{XY}^{2}}{\sigma_{Y}^{2}}\).
Therefore, the Gibbs sampler for bivariate normal distribution consists of iterating as the following:</p>

<ol>
<li>Draw \(\displaystyle x_{t+1}\sim N\left(\mu_{X}+\frac{\sigma_{XY}}{\sigma_{Y}^{2}}(y_{t}-\mu_{Y}), \sigma_{X}^{2}-\frac{\sigma_{XY}^{2}}{\sigma_{Y}^{2}}\right)\)</li>
<li>Draw \(\displaystyle y_{t+1}\sim N\left(\mu_{Y}+\frac{\sigma_{XY}}{\sigma_{X}^{2}}(x_{t+1}-\mu_{Y}), \sigma_{Y}^{2}-\frac{\sigma_{XY}^{2}}{\sigma_{X}^{2}}\right)\)</li>
</ol>

<p>And it can be naturally translated into F# code as the following.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 32)" onmouseover="showTip(event, 'fs18', 32)" class="i">gibbsBinormal</span> (<span onmouseout="hideTip(event, 'fs19', 33)" onmouseover="showTip(event, 'fs19', 33)" class="i">meanX</span>, <span onmouseout="hideTip(event, 'fs20', 34)" onmouseover="showTip(event, 'fs20', 34)" class="i">meanY</span>, <span onmouseout="hideTip(event, 'fs21', 35)" onmouseover="showTip(event, 'fs21', 35)" class="i">varX</span>, <span onmouseout="hideTip(event, 'fs22', 36)" onmouseover="showTip(event, 'fs22', 36)" class="i">varY</span>, <span onmouseout="hideTip(event, 'fs23', 37)" onmouseover="showTip(event, 'fs23', 37)" class="i">cov</span>) <span class="o">=</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 38)" onmouseover="showTip(event, 'fs24', 38)" class="i">sdx</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 39)" onmouseover="showTip(event, 'fs25', 39)" class="i">sqrt</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs21', 40)" onmouseover="showTip(event, 'fs21', 40)" class="i">varX</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs23', 41)" onmouseover="showTip(event, 'fs23', 41)" class="i">cov</span> <span class="o">**</span> <span class="n">2.0</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs22', 42)" onmouseover="showTip(event, 'fs22', 42)" class="i">varY</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 43)" onmouseover="showTip(event, 'fs26', 43)" class="i">sdy</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 44)" onmouseover="showTip(event, 'fs25', 44)" class="i">sqrt</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs22', 45)" onmouseover="showTip(event, 'fs22', 45)" class="i">varY</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs23', 46)" onmouseover="showTip(event, 'fs23', 46)" class="i">cov</span> <span class="o">**</span> <span class="n">2.0</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs21', 47)" onmouseover="showTip(event, 'fs21', 47)" class="i">varX</span>
   <span class="k">fun</span> (_, <span onmouseout="hideTip(event, 'fs7', 48)" onmouseover="showTip(event, 'fs7', 48)" class="i">y</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs4', 49)" onmouseover="showTip(event, 'fs4', 49)" class="i">random</span> {
      <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs27', 50)" onmouseover="showTip(event, 'fs27', 50)" class="i">x&#39;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs28', 51)" onmouseover="showTip(event, 'fs28', 51)" class="i">normal</span> (<span onmouseout="hideTip(event, 'fs19', 52)" onmouseover="showTip(event, 'fs19', 52)" class="i">meanX</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs23', 53)" onmouseover="showTip(event, 'fs23', 53)" class="i">cov</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs7', 54)" onmouseover="showTip(event, 'fs7', 54)" class="i">y</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs20', 55)" onmouseover="showTip(event, 'fs20', 55)" class="i">meanY</span>) <span class="o">/</span> <span onmouseout="hideTip(event, 'fs22', 56)" onmouseover="showTip(event, 'fs22', 56)" class="i">varY</span>, <span onmouseout="hideTip(event, 'fs24', 57)" onmouseover="showTip(event, 'fs24', 57)" class="i">sdx</span>)
      <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs29', 58)" onmouseover="showTip(event, 'fs29', 58)" class="i">y&#39;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs28', 59)" onmouseover="showTip(event, 'fs28', 59)" class="i">normal</span> (<span onmouseout="hideTip(event, 'fs20', 60)" onmouseover="showTip(event, 'fs20', 60)" class="i">meanY</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="i">cov</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs27', 62)" onmouseover="showTip(event, 'fs27', 62)" class="i">x&#39;</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs19', 63)" onmouseover="showTip(event, 'fs19', 63)" class="i">meanX</span>) <span class="o">/</span> <span onmouseout="hideTip(event, 'fs21', 64)" onmouseover="showTip(event, 'fs21', 64)" class="i">varX</span>, <span onmouseout="hideTip(event, 'fs26', 65)" onmouseover="showTip(event, 'fs26', 65)" class="i">sdy</span>)
      <span class="k">return</span> (<span onmouseout="hideTip(event, 'fs27', 66)" onmouseover="showTip(event, 'fs27', 66)" class="i">x&#39;</span>, <span onmouseout="hideTip(event, 'fs29', 67)" onmouseover="showTip(event, 'fs29', 67)" class="i">y&#39;</span>)
   }
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 68)" onmouseover="showTip(event, 'fs30', 68)" class="i">binormal</span> <span onmouseout="hideTip(event, 'fs31', 69)" onmouseover="showTip(event, 'fs31', 69)" class="i">parameter</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs12', 70)" onmouseover="showTip(event, 'fs12', 70)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 71)" onmouseover="showTip(event, 'fs32', 71)" class="i">markovChain</span> (<span onmouseout="hideTip(event, 'fs18', 72)" onmouseover="showTip(event, 'fs18', 72)" class="i">gibbsBinormal</span> <span onmouseout="hideTip(event, 'fs31', 73)" onmouseover="showTip(event, 'fs31', 73)" class="i">parameter</span>)</pre>
</td>
</tr>
</table>

<p>Note that the generating bivariate normal random number sequence is <a href="http://en.wikipedia.org/wiki/Autocorrelation">autocorrelated</a>.</p>

<a name="hamiltonian-monte-carlo"></a>

<h2>Hamiltonian Monte Carlo</h2>

<p>Gibbs sampler sometimes produces strongly autocorrelated traces.
Hamiltonian Monte Carlo (also known as <a href="http://en.wikipedia.org/wiki/Hybrid_Monte_Carlo">hybrid Monte Carlo</a>)
could be efficient in such situations.
Hamiltonian Monte Carlo algorithm is available
if you know about the density of the taget distribution without normalizing constant.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span class="k">inline</span> <span onmouseout="hideTip(event, 'fs33', 74)" onmouseover="showTip(event, 'fs33', 74)" class="i">updateWith</span> <span onmouseout="hideTip(event, 'fs34', 75)" onmouseover="showTip(event, 'fs34', 75)" class="i">f</span> (<span onmouseout="hideTip(event, 'fs35', 76)" onmouseover="showTip(event, 'fs35', 76)" class="i">ys</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs36', 77)" onmouseover="showTip(event, 'fs36', 77)" class="i">float</span> []) (<span onmouseout="hideTip(event, 'fs37', 78)" onmouseover="showTip(event, 'fs37', 78)" class="i">xs</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs36', 79)" onmouseover="showTip(event, 'fs36', 79)" class="i">float</span> []) <span class="o">=</span>
   <span class="k">for</span> <span onmouseout="hideTip(event, 'fs38', 80)" onmouseover="showTip(event, 'fs38', 80)" class="i">index</span> <span class="o">=</span> <span class="n">0</span> <span class="k">to</span> <span onmouseout="hideTip(event, 'fs39', 81)" onmouseover="showTip(event, 'fs39', 81)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 82)" onmouseover="showTip(event, 'fs40', 82)" class="i">length</span> <span onmouseout="hideTip(event, 'fs37', 83)" onmouseover="showTip(event, 'fs37', 83)" class="i">xs</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span>
      <span onmouseout="hideTip(event, 'fs37', 84)" onmouseover="showTip(event, 'fs37', 84)" class="i">xs</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs38', 85)" onmouseover="showTip(event, 'fs38', 85)" class="i">index</span>] <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs34', 86)" onmouseover="showTip(event, 'fs34', 86)" class="i">f</span> <span onmouseout="hideTip(event, 'fs37', 87)" onmouseover="showTip(event, 'fs37', 87)" class="i">xs</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs38', 88)" onmouseover="showTip(event, 'fs38', 88)" class="i">index</span>] <span onmouseout="hideTip(event, 'fs35', 89)" onmouseover="showTip(event, 'fs35', 89)" class="i">ys</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs38', 90)" onmouseover="showTip(event, 'fs38', 90)" class="i">index</span>]

<span class="c">/// Hamiltonian Monte Carlo</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs41', 91)" onmouseover="showTip(event, 'fs41', 91)" class="i">hmc</span> <span onmouseout="hideTip(event, 'fs42', 92)" onmouseover="showTip(event, 'fs42', 92)" class="i">minusLogDensity</span> <span onmouseout="hideTip(event, 'fs43', 93)" onmouseover="showTip(event, 'fs43', 93)" class="i">gradMinusLogDensity</span> <span onmouseout="hideTip(event, 'fs44', 94)" onmouseover="showTip(event, 'fs44', 94)" class="i">epsilon</span> <span onmouseout="hideTip(event, 'fs45', 95)" onmouseover="showTip(event, 'fs45', 95)" class="i">step</span> <span class="o">=</span>
   <span class="c">/// Leapfrog integration</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 96)" onmouseover="showTip(event, 'fs46', 96)" class="i">leapfrog</span> <span onmouseout="hideTip(event, 'fs47', 97)" onmouseover="showTip(event, 'fs47', 97)" class="i">q</span> <span onmouseout="hideTip(event, 'fs48', 98)" onmouseover="showTip(event, 'fs48', 98)" class="i">p</span> <span class="o">=</span>
      <span onmouseout="hideTip(event, 'fs33', 99)" onmouseover="showTip(event, 'fs33', 99)" class="i">updateWith</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs5', 100)" onmouseover="showTip(event, 'fs5', 100)" class="i">x</span> <span onmouseout="hideTip(event, 'fs7', 101)" onmouseover="showTip(event, 'fs7', 101)" class="i">y</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs5', 102)" onmouseover="showTip(event, 'fs5', 102)" class="i">x</span> <span class="o">+</span> <span class="n">0.5</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs44', 103)" onmouseover="showTip(event, 'fs44', 103)" class="i">epsilon</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs7', 104)" onmouseover="showTip(event, 'fs7', 104)" class="i">y</span>) (<span onmouseout="hideTip(event, 'fs43', 105)" onmouseover="showTip(event, 'fs43', 105)" class="i">gradMinusLogDensity</span> <span onmouseout="hideTip(event, 'fs47', 106)" onmouseover="showTip(event, 'fs47', 106)" class="i">q</span>) <span onmouseout="hideTip(event, 'fs48', 107)" onmouseover="showTip(event, 'fs48', 107)" class="i">p</span>
      <span class="k">for</span> <span onmouseout="hideTip(event, 'fs49', 108)" onmouseover="showTip(event, 'fs49', 108)" class="i">i</span> <span class="o">=</span> <span class="n">1</span> <span class="k">to</span> <span onmouseout="hideTip(event, 'fs45', 109)" onmouseover="showTip(event, 'fs45', 109)" class="i">step</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span>
         <span onmouseout="hideTip(event, 'fs33', 110)" onmouseover="showTip(event, 'fs33', 110)" class="i">updateWith</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs5', 111)" onmouseover="showTip(event, 'fs5', 111)" class="i">x</span> <span onmouseout="hideTip(event, 'fs7', 112)" onmouseover="showTip(event, 'fs7', 112)" class="i">y</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs5', 113)" onmouseover="showTip(event, 'fs5', 113)" class="i">x</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs44', 114)" onmouseover="showTip(event, 'fs44', 114)" class="i">epsilon</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs7', 115)" onmouseover="showTip(event, 'fs7', 115)" class="i">y</span>) <span onmouseout="hideTip(event, 'fs48', 116)" onmouseover="showTip(event, 'fs48', 116)" class="i">p</span> <span onmouseout="hideTip(event, 'fs47', 117)" onmouseover="showTip(event, 'fs47', 117)" class="i">q</span>
         <span onmouseout="hideTip(event, 'fs33', 118)" onmouseover="showTip(event, 'fs33', 118)" class="i">updateWith</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs5', 119)" onmouseover="showTip(event, 'fs5', 119)" class="i">x</span> <span onmouseout="hideTip(event, 'fs7', 120)" onmouseover="showTip(event, 'fs7', 120)" class="i">y</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs5', 121)" onmouseover="showTip(event, 'fs5', 121)" class="i">x</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs44', 122)" onmouseover="showTip(event, 'fs44', 122)" class="i">epsilon</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs7', 123)" onmouseover="showTip(event, 'fs7', 123)" class="i">y</span>) (<span onmouseout="hideTip(event, 'fs43', 124)" onmouseover="showTip(event, 'fs43', 124)" class="i">gradMinusLogDensity</span> <span onmouseout="hideTip(event, 'fs47', 125)" onmouseover="showTip(event, 'fs47', 125)" class="i">q</span>) <span onmouseout="hideTip(event, 'fs48', 126)" onmouseover="showTip(event, 'fs48', 126)" class="i">p</span>
      <span onmouseout="hideTip(event, 'fs33', 127)" onmouseover="showTip(event, 'fs33', 127)" class="i">updateWith</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs5', 128)" onmouseover="showTip(event, 'fs5', 128)" class="i">x</span> <span onmouseout="hideTip(event, 'fs7', 129)" onmouseover="showTip(event, 'fs7', 129)" class="i">y</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs5', 130)" onmouseover="showTip(event, 'fs5', 130)" class="i">x</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs44', 131)" onmouseover="showTip(event, 'fs44', 131)" class="i">epsilon</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs7', 132)" onmouseover="showTip(event, 'fs7', 132)" class="i">y</span>) <span onmouseout="hideTip(event, 'fs48', 133)" onmouseover="showTip(event, 'fs48', 133)" class="i">p</span> <span onmouseout="hideTip(event, 'fs47', 134)" onmouseover="showTip(event, 'fs47', 134)" class="i">q</span>
      <span onmouseout="hideTip(event, 'fs33', 135)" onmouseover="showTip(event, 'fs33', 135)" class="i">updateWith</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs5', 136)" onmouseover="showTip(event, 'fs5', 136)" class="i">x</span> <span onmouseout="hideTip(event, 'fs7', 137)" onmouseover="showTip(event, 'fs7', 137)" class="i">y</span> <span class="k">-&gt;</span> <span class="o">-</span><span onmouseout="hideTip(event, 'fs5', 138)" onmouseover="showTip(event, 'fs5', 138)" class="i">x</span> <span class="o">+</span> <span class="n">0.5</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs44', 139)" onmouseover="showTip(event, 'fs44', 139)" class="i">epsilon</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs7', 140)" onmouseover="showTip(event, 'fs7', 140)" class="i">y</span>) (<span onmouseout="hideTip(event, 'fs43', 141)" onmouseover="showTip(event, 'fs43', 141)" class="i">gradMinusLogDensity</span> <span onmouseout="hideTip(event, 'fs47', 142)" onmouseover="showTip(event, 'fs47', 142)" class="i">q</span>) <span onmouseout="hideTip(event, 'fs48', 143)" onmouseover="showTip(event, 'fs48', 143)" class="i">p</span>
   <span class="c">/// Hamiltonian</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs50', 144)" onmouseover="showTip(event, 'fs50', 144)" class="i">hamiltonian</span> <span onmouseout="hideTip(event, 'fs47', 145)" onmouseover="showTip(event, 'fs47', 145)" class="i">q</span> <span onmouseout="hideTip(event, 'fs48', 146)" onmouseover="showTip(event, 'fs48', 146)" class="i">p</span> <span class="o">=</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 147)" onmouseover="showTip(event, 'fs51', 147)" class="i">potential</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 148)" onmouseover="showTip(event, 'fs42', 148)" class="i">minusLogDensity</span> <span onmouseout="hideTip(event, 'fs47', 149)" onmouseover="showTip(event, 'fs47', 149)" class="i">q</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 150)" onmouseover="showTip(event, 'fs52', 150)" class="i">kinetic</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 151)" onmouseover="showTip(event, 'fs39', 151)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 152)" onmouseover="showTip(event, 'fs53', 152)" class="i">fold</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs54', 153)" onmouseover="showTip(event, 'fs54', 153)" class="i">acc</span> <span onmouseout="hideTip(event, 'fs5', 154)" onmouseover="showTip(event, 'fs5', 154)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs54', 155)" onmouseover="showTip(event, 'fs54', 155)" class="i">acc</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs5', 156)" onmouseover="showTip(event, 'fs5', 156)" class="i">x</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs5', 157)" onmouseover="showTip(event, 'fs5', 157)" class="i">x</span>) <span class="n">0.0</span> <span onmouseout="hideTip(event, 'fs48', 158)" onmouseover="showTip(event, 'fs48', 158)" class="i">p</span> <span class="o">/</span> <span class="n">2.0</span>
      <span onmouseout="hideTip(event, 'fs51', 159)" onmouseover="showTip(event, 'fs51', 159)" class="i">potential</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs52', 160)" onmouseover="showTip(event, 'fs52', 160)" class="i">kinetic</span>
   <span class="c">/// resampling of particles</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 161)" onmouseover="showTip(event, 'fs55', 161)" class="i">resampleK</span> <span onmouseout="hideTip(event, 'fs56', 162)" onmouseover="showTip(event, 'fs56', 162)" class="i">n</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 163)" onmouseover="showTip(event, 'fs39', 163)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 164)" onmouseover="showTip(event, 'fs57', 164)" class="i">randomCreate</span> <span onmouseout="hideTip(event, 'fs56', 165)" onmouseover="showTip(event, 'fs56', 165)" class="i">n</span> <span onmouseout="hideTip(event, 'fs58', 166)" onmouseover="showTip(event, 'fs58', 166)" class="i">Standard</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 167)" onmouseover="showTip(event, 'fs59', 167)" class="i">normal</span>
   <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs60', 168)" onmouseover="showTip(event, 'fs60', 168)" class="i">currentQ</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs4', 169)" onmouseover="showTip(event, 'fs4', 169)" class="i">random</span> {
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs47', 170)" onmouseover="showTip(event, 'fs47', 170)" class="i">q</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 171)" onmouseover="showTip(event, 'fs39', 171)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 172)" onmouseover="showTip(event, 'fs61', 172)" class="i">copy</span> <span onmouseout="hideTip(event, 'fs60', 173)" onmouseover="showTip(event, 'fs60', 173)" class="i">currentQ</span>
      <span class="c">// resampling of particles</span>
      <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs62', 174)" onmouseover="showTip(event, 'fs62', 174)" class="i">currentP</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs55', 175)" onmouseover="showTip(event, 'fs55', 175)" class="i">resampleK</span> (<span onmouseout="hideTip(event, 'fs39', 176)" onmouseover="showTip(event, 'fs39', 176)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 177)" onmouseover="showTip(event, 'fs40', 177)" class="i">length</span> <span onmouseout="hideTip(event, 'fs60', 178)" onmouseover="showTip(event, 'fs60', 178)" class="i">currentQ</span>)
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs48', 179)" onmouseover="showTip(event, 'fs48', 179)" class="i">p</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 180)" onmouseover="showTip(event, 'fs39', 180)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 181)" onmouseover="showTip(event, 'fs61', 181)" class="i">copy</span> <span onmouseout="hideTip(event, 'fs62', 182)" onmouseover="showTip(event, 'fs62', 182)" class="i">currentP</span>
      <span onmouseout="hideTip(event, 'fs46', 183)" onmouseover="showTip(event, 'fs46', 183)" class="i">leapfrog</span> <span onmouseout="hideTip(event, 'fs47', 184)" onmouseover="showTip(event, 'fs47', 184)" class="i">q</span> <span onmouseout="hideTip(event, 'fs48', 185)" onmouseover="showTip(event, 'fs48', 185)" class="i">p</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs63', 186)" onmouseover="showTip(event, 'fs63', 186)" class="i">currentH</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 187)" onmouseover="showTip(event, 'fs50', 187)" class="i">hamiltonian</span> <span onmouseout="hideTip(event, 'fs60', 188)" onmouseover="showTip(event, 'fs60', 188)" class="i">currentQ</span> <span onmouseout="hideTip(event, 'fs62', 189)" onmouseover="showTip(event, 'fs62', 189)" class="i">currentP</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 190)" onmouseover="showTip(event, 'fs64', 190)" class="i">proposedH</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 191)" onmouseover="showTip(event, 'fs50', 191)" class="i">hamiltonian</span> <span onmouseout="hideTip(event, 'fs47', 192)" onmouseover="showTip(event, 'fs47', 192)" class="i">q</span> <span onmouseout="hideTip(event, 'fs48', 193)" onmouseover="showTip(event, 'fs48', 193)" class="i">p</span>
      <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs65', 194)" onmouseover="showTip(event, 'fs65', 194)" class="i">r</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs66', 195)" onmouseover="showTip(event, 'fs66', 195)" class="i">``[0, 1)``</span>
      <span class="k">return</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs65', 196)" onmouseover="showTip(event, 'fs65', 196)" class="i">r</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs67', 197)" onmouseover="showTip(event, 'fs67', 197)" class="i">exp</span> (<span onmouseout="hideTip(event, 'fs63', 198)" onmouseover="showTip(event, 'fs63', 198)" class="i">currentH</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs64', 199)" onmouseover="showTip(event, 'fs64', 199)" class="i">proposedH</span>) <span class="k">then</span> <span onmouseout="hideTip(event, 'fs47', 200)" onmouseover="showTip(event, 'fs47', 200)" class="i">q</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs60', 201)" onmouseover="showTip(event, 'fs60', 201)" class="i">currentQ</span>
   }</pre>
</td>
</tr>
</table>

<a name="approximate-bayesian-computation"></a>

<h2>Approximate Bayesian Computation</h2>

<p><a href="http://en.wikipedia.org/wiki/Approximate_Bayesian_computation">Approximate Bayesian computation</a>
is known as a likelihood-free method of parameter estimation.
This section follows the example in the Wikipedia article.</p>

<p>The initial state of the system is not described whether it is determined or inferred.
Here it is assumed as 'A' for convenience.
Then, the model is described as follows:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs68', 202)" onmouseover="showTip(event, 'fs68', 202)" class="i">HiddenSystem</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs69', 203)" onmouseover="showTip(event, 'fs69', 203)" class="i">A</span> | <span onmouseout="hideTip(event, 'fs70', 204)" onmouseover="showTip(event, 'fs70', 204)" class="i">B</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs71', 205)" onmouseover="showTip(event, 'fs71', 205)" class="i">switch</span> <span class="o">=</span> <span class="k">function</span> <span onmouseout="hideTip(event, 'fs69', 206)" onmouseover="showTip(event, 'fs69', 206)" class="i">A</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs70', 207)" onmouseover="showTip(event, 'fs70', 207)" class="i">B</span> | <span onmouseout="hideTip(event, 'fs70', 208)" onmouseover="showTip(event, 'fs70', 208)" class="i">B</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs69', 209)" onmouseover="showTip(event, 'fs69', 209)" class="i">A</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs72', 210)" onmouseover="showTip(event, 'fs72', 210)" class="i">observe</span> <span onmouseout="hideTip(event, 'fs73', 211)" onmouseover="showTip(event, 'fs73', 211)" class="i">correctly</span> <span class="o">=</span> <span class="k">function</span>
   | <span onmouseout="hideTip(event, 'fs69', 212)" onmouseover="showTip(event, 'fs69', 212)" class="i">A</span> <span class="k">-&gt;</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs73', 213)" onmouseover="showTip(event, 'fs73', 213)" class="i">correctly</span> <span class="k">then</span> <span class="s">&#39;A&#39;</span> <span class="k">else</span> <span class="s">&#39;B&#39;</span>
   | <span onmouseout="hideTip(event, 'fs70', 214)" onmouseover="showTip(event, 'fs70', 214)" class="i">B</span> <span class="k">-&gt;</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs73', 215)" onmouseover="showTip(event, 'fs73', 215)" class="i">correctly</span> <span class="k">then</span> <span class="s">&#39;B&#39;</span> <span class="k">else</span> <span class="s">&#39;A&#39;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs74', 216)" onmouseover="showTip(event, 'fs74', 216)" class="i">model</span> (<span onmouseout="hideTip(event, 'fs75', 217)" onmouseover="showTip(event, 'fs75', 217)" class="i">theta</span>, <span onmouseout="hideTip(event, 'fs76', 218)" onmouseover="showTip(event, 'fs76', 218)" class="i">gamma</span>, <span onmouseout="hideTip(event, 'fs77', 219)" onmouseover="showTip(event, 'fs77', 219)" class="i">length</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 220)" onmouseover="showTip(event, 'fs4', 220)" class="i">random</span> {
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs78', 221)" onmouseover="showTip(event, 'fs78', 221)" class="i">state</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs79', 222)" onmouseover="showTip(event, 'fs79', 222)" class="i">ref</span> <span onmouseout="hideTip(event, 'fs69', 223)" onmouseover="showTip(event, 'fs69', 223)" class="i">A</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs80', 224)" onmouseover="showTip(event, 'fs80', 224)" class="i">builder</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs81', 225)" onmouseover="showTip(event, 'fs81', 225)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 226)" onmouseover="showTip(event, 'fs82', 226)" class="i">Text</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs83', 227)" onmouseover="showTip(event, 'fs83', 227)" class="i">StringBuilder</span> ()
   <span class="k">for</span> <span onmouseout="hideTip(event, 'fs38', 228)" onmouseover="showTip(event, 'fs38', 228)" class="i">index</span> <span class="o">=</span> <span class="n">1</span> <span class="k">to</span> <span onmouseout="hideTip(event, 'fs77', 229)" onmouseover="showTip(event, 'fs77', 229)" class="i">length</span> <span class="k">do</span>
      <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs84', 230)" onmouseover="showTip(event, 'fs84', 230)" class="i">switchState</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs85', 231)" onmouseover="showTip(event, 'fs85', 231)" class="i">Utility</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 232)" onmouseover="showTip(event, 'fs86', 232)" class="i">flipCoin</span> <span onmouseout="hideTip(event, 'fs75', 233)" onmouseover="showTip(event, 'fs75', 233)" class="i">theta</span>
      <span class="k">if</span> <span onmouseout="hideTip(event, 'fs84', 234)" onmouseover="showTip(event, 'fs84', 234)" class="i">switchState</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs78', 235)" onmouseover="showTip(event, 'fs78', 235)" class="i">state</span> <span class="o">:=</span> <span onmouseout="hideTip(event, 'fs71', 236)" onmouseover="showTip(event, 'fs71', 236)" class="i">switch</span> <span class="o">!</span><span onmouseout="hideTip(event, 'fs78', 237)" onmouseover="showTip(event, 'fs78', 237)" class="i">state</span>
      <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs73', 238)" onmouseover="showTip(event, 'fs73', 238)" class="i">correctly</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs85', 239)" onmouseover="showTip(event, 'fs85', 239)" class="i">Utility</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 240)" onmouseover="showTip(event, 'fs86', 240)" class="i">flipCoin</span> <span onmouseout="hideTip(event, 'fs76', 241)" onmouseover="showTip(event, 'fs76', 241)" class="i">gamma</span>
      <span onmouseout="hideTip(event, 'fs80', 242)" onmouseover="showTip(event, 'fs80', 242)" class="i">builder</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs87', 243)" onmouseover="showTip(event, 'fs87', 243)" class="i">Append</span> (<span onmouseout="hideTip(event, 'fs72', 244)" onmouseover="showTip(event, 'fs72', 244)" class="i">observe</span> <span onmouseout="hideTip(event, 'fs73', 245)" onmouseover="showTip(event, 'fs73', 245)" class="i">correctly</span> <span class="o">!</span><span onmouseout="hideTip(event, 'fs78', 246)" onmouseover="showTip(event, 'fs78', 246)" class="i">state</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs88', 247)" onmouseover="showTip(event, 'fs88', 247)" class="i">ignore</span>
   <span class="k">return</span> <span onmouseout="hideTip(event, 'fs80', 248)" onmouseover="showTip(event, 'fs80', 248)" class="i">builder</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 249)" onmouseover="showTip(event, 'fs89', 249)" class="i">ToString</span> ()
}</pre>
</td>
</tr>
</table>

<p>Step 1: the observed data is <code>AAAABAABBAAAAAABAAAA</code>.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs90', 250)" onmouseover="showTip(event, 'fs90', 250)" class="i">observed</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">AAAABAABBAAAAAABAAAA</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<p>Step 2: the prior of theta is a uniform [0, 1] and gamma is known.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs91', 251)" onmouseover="showTip(event, 'fs91', 251)" class="i">prior</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 252)" onmouseover="showTip(event, 'fs6', 252)" class="i">uniform</span> (<span class="n">0.0</span>, <span class="n">1.0</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs92', 253)" onmouseover="showTip(event, 'fs92', 253)" class="i">gamma</span> <span class="o">=</span> <span class="n">0.8</span></pre>
</td>
</tr>
</table>

<p>Step 3: the summary statistic is the frequency of switches between two states (A and B).
Note that the summary statistic is bad to estimate theta (see the article).</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs93', 254)" onmouseover="showTip(event, 'fs93', 254)" class="i">w</span> (<span onmouseout="hideTip(event, 'fs94', 255)" onmouseover="showTip(event, 'fs94', 255)" class="i">data</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs95', 256)" onmouseover="showTip(event, 'fs95', 256)" class="i">string</span>) <span class="o">=</span>
   <span onmouseout="hideTip(event, 'fs12', 257)" onmouseover="showTip(event, 'fs12', 257)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs96', 258)" onmouseover="showTip(event, 'fs96', 258)" class="i">windowed</span> <span class="n">2</span> <span onmouseout="hideTip(event, 'fs94', 259)" onmouseover="showTip(event, 'fs94', 259)" class="i">data</span>
   <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs12', 260)" onmouseover="showTip(event, 'fs12', 260)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs97', 261)" onmouseover="showTip(event, 'fs97', 261)" class="i">filter</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs98', 262)" onmouseover="showTip(event, 'fs98', 262)" class="i">c</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs98', 263)" onmouseover="showTip(event, 'fs98', 263)" class="i">c</span><span class="o">.</span>[<span class="n">0</span>] <span class="o">&lt;&gt;</span> <span onmouseout="hideTip(event, 'fs98', 264)" onmouseover="showTip(event, 'fs98', 264)" class="i">c</span><span class="o">.</span>[<span class="n">1</span>])  <span class="c">// switch</span>
   <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs12', 265)" onmouseover="showTip(event, 'fs12', 265)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs99', 266)" onmouseover="showTip(event, 'fs99', 266)" class="i">length</span></pre>
</td>
</tr>
</table>

<p>Step 4: the distance between the observed and simulated is the difference between the summary statistics.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs100', 267)" onmouseover="showTip(event, 'fs100', 267)" class="i">rho</span> <span onmouseout="hideTip(event, 'fs101', 268)" onmouseover="showTip(event, 'fs101', 268)" class="i">simulated</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs102', 269)" onmouseover="showTip(event, 'fs102', 269)" class="i">abs</span> (<span onmouseout="hideTip(event, 'fs93', 270)" onmouseover="showTip(event, 'fs93', 270)" class="i">w</span> <span onmouseout="hideTip(event, 'fs90', 271)" onmouseover="showTip(event, 'fs90', 271)" class="i">observed</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs93', 272)" onmouseover="showTip(event, 'fs93', 272)" class="i">w</span> <span onmouseout="hideTip(event, 'fs101', 273)" onmouseover="showTip(event, 'fs101', 273)" class="i">simulated</span>)</pre>
</td>
</tr>
</table>

<p>Step 5: do the simulation with tolerance epsilon.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs103', 274)" onmouseover="showTip(event, 'fs103', 274)" class="i">SimulationResult</span> <span class="o">=</span>
   | <span onmouseout="hideTip(event, 'fs104', 275)" onmouseover="showTip(event, 'fs104', 275)" class="i">Accept</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs36', 276)" onmouseover="showTip(event, 'fs36', 276)" class="i">float</span>
   | <span onmouseout="hideTip(event, 'fs105', 277)" onmouseover="showTip(event, 'fs105', 277)" class="i">Reject</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs106', 278)" onmouseover="showTip(event, 'fs106', 278)" class="i">simulate</span> <span onmouseout="hideTip(event, 'fs107', 279)" onmouseover="showTip(event, 'fs107', 279)" class="i">epsilon</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 280)" onmouseover="showTip(event, 'fs4', 280)" class="i">random</span> {
   <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs75', 281)" onmouseover="showTip(event, 'fs75', 281)" class="i">theta</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs91', 282)" onmouseover="showTip(event, 'fs91', 282)" class="i">prior</span>
   <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs101', 283)" onmouseover="showTip(event, 'fs101', 283)" class="i">simulated</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs74', 284)" onmouseover="showTip(event, 'fs74', 284)" class="i">model</span> (<span onmouseout="hideTip(event, 'fs75', 285)" onmouseover="showTip(event, 'fs75', 285)" class="i">theta</span>, <span onmouseout="hideTip(event, 'fs92', 286)" onmouseover="showTip(event, 'fs92', 286)" class="i">gamma</span>, <span onmouseout="hideTip(event, 'fs108', 287)" onmouseover="showTip(event, 'fs108', 287)" class="i">String</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs109', 288)" onmouseover="showTip(event, 'fs109', 288)" class="i">length</span> <span onmouseout="hideTip(event, 'fs90', 289)" onmouseover="showTip(event, 'fs90', 289)" class="i">observed</span>)
   <span class="k">return</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs100', 290)" onmouseover="showTip(event, 'fs100', 290)" class="i">rho</span> <span onmouseout="hideTip(event, 'fs101', 291)" onmouseover="showTip(event, 'fs101', 291)" class="i">simulated</span> <span class="o">&lt;=</span> <span onmouseout="hideTip(event, 'fs107', 292)" onmouseover="showTip(event, 'fs107', 292)" class="i">epsilon</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs104', 293)" onmouseover="showTip(event, 'fs104', 293)" class="i">Accept</span> (<span onmouseout="hideTip(event, 'fs75', 294)" onmouseover="showTip(event, 'fs75', 294)" class="i">theta</span>) <span class="k">else</span> <span onmouseout="hideTip(event, 'fs105', 295)" onmouseover="showTip(event, 'fs105', 295)" class="i">Reject</span>
}</pre>
</td>
</tr>
</table>

<div class="tip" id="fs1">namespace FsRandom</div>
<div class="tip" id="fs2">module Statistics<br /><br />from FsRandom</div>
<div class="tip" id="fs3">val randomPointGenerator : GeneratorFunction&lt;float * float&gt;<br /><br />Full name: Numerical-examples.randomPointGenerator</div>
<div class="tip" id="fs4">val random : RandomBuilder<br /><br />Full name: FsRandom.RandomNumberGenerator.random</div>
<div class="tip" id="fs5">val x : float</div>
<div class="tip" id="fs6">val uniform : min:float * max:float -&gt; GeneratorFunction&lt;float&gt;<br /><br />Full name: FsRandom.Statistics.uniform</div>
<div class="tip" id="fs7">val y : float</div>
<div class="tip" id="fs8">val weight : x:float * y:float -&gt; float<br /><br />Full name: Numerical-examples.weight</div>
<div class="tip" id="fs9">val randomScoreGenerator : GeneratorFunction&lt;float&gt;<br /><br />Full name: Numerical-examples.randomScoreGenerator</div>
<div class="tip" id="fs10">module Random<br /><br />from FsRandom</div>
<div class="tip" id="fs11">val map : transformation:(&#39;a -&gt; &#39;b) -&gt; generator:GeneratorFunction&lt;&#39;a&gt; -&gt; GeneratorFunction&lt;&#39;b&gt;<br /><br />Full name: FsRandom.Random.map</div>
<div class="tip" id="fs12">Multiple items<br />module Seq<br /><br />from FsRandom.StatisticsModule<br /><br />--------------------<br />module Seq<br /><br />from FsRandom<br /><br />--------------------<br />module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs13">val ofRandom : generator:GeneratorFunction&lt;&#39;a&gt; -&gt; (PrngState -&gt; seq&lt;&#39;a&gt;)<br /><br />Full name: FsRandom.Seq.ofRandom</div>
<div class="tip" id="fs14">val state : PrngState<br /><br />Full name: Numerical-examples.state</div>
<div class="tip" id="fs15">val take : count:int -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.take</div>
<div class="tip" id="fs16">val average : source:seq&lt;&#39;T&gt; -&gt; &#39;T (requires member ( + ) and member DivideByInt and member get_Zero)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.average</div>
<div class="tip" id="fs17">val printf : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printf</div>
<div class="tip" id="fs18">val gibbsBinormal : meanX:float * meanY:float * varX:float * varY:float * cov:float -&gt; (&#39;a * float -&gt; GeneratorFunction&lt;float * float&gt;)<br /><br />Full name: Numerical-examples.gibbsBinormal</div>
<div class="tip" id="fs19">val meanX : float</div>
<div class="tip" id="fs20">val meanY : float</div>
<div class="tip" id="fs21">val varX : float</div>
<div class="tip" id="fs22">val varY : float</div>
<div class="tip" id="fs23">val cov : float</div>
<div class="tip" id="fs24">val sdx : float</div>
<div class="tip" id="fs25">val sqrt : value:&#39;T -&gt; &#39;U (requires member Sqrt)<br /><br />Full name: Microsoft.FSharp.Core.Operators.sqrt</div>
<div class="tip" id="fs26">val sdy : float</div>
<div class="tip" id="fs27">val x&#39; : float</div>
<div class="tip" id="fs28">val normal : mean:float * standardDeviation:float -&gt; GeneratorFunction&lt;float&gt;<br /><br />Full name: FsRandom.Statistics.normal</div>
<div class="tip" id="fs29">val y&#39; : float</div>
<div class="tip" id="fs30">val binormal : float * float * float * float * float -&gt; (float * float -&gt; PrngState -&gt; seq&lt;float * float&gt;)<br /><br />Full name: Numerical-examples.binormal</div>
<div class="tip" id="fs31">val parameter : float * float * float * float * float</div>
<div class="tip" id="fs32">val markovChain : generator:(&#39;a -&gt; GeneratorFunction&lt;&#39;a&gt;) -&gt; (&#39;a -&gt; PrngState -&gt; seq&lt;&#39;a&gt;)<br /><br />Full name: FsRandom.StatisticsModule.Seq.markovChain</div>
<div class="tip" id="fs33">val updateWith : f:(float -&gt; float -&gt; float) -&gt; ys:float [] -&gt; xs:float [] -&gt; unit<br /><br />Full name: Numerical-examples.updateWith</div>
<div class="tip" id="fs34">val f : (float -&gt; float -&gt; float)</div>
<div class="tip" id="fs35">val ys : float []</div>
<div class="tip" id="fs36">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs37">val xs : float []</div>
<div class="tip" id="fs38">val index : int</div>
<div class="tip" id="fs39">Multiple items<br />module Array<br /><br />from FsRandom<br /><br />--------------------<br />module Array<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs40">val length : array:&#39;T [] -&gt; int<br /><br />Full name: Microsoft.FSharp.Collections.Array.length</div>
<div class="tip" id="fs41">val hmc : minusLogDensity:(float [] -&gt; float) -&gt; gradMinusLogDensity:(float [] -&gt; float []) -&gt; epsilon:float -&gt; step:int -&gt; (float [] -&gt; GeneratorFunction&lt;float []&gt;)<br /><br />Full name: Numerical-examples.hmc<br /><em><br /><br />&#160;Hamiltonian Monte Carlo</em></div>
<div class="tip" id="fs42">val minusLogDensity : (float [] -&gt; float)</div>
<div class="tip" id="fs43">val gradMinusLogDensity : (float [] -&gt; float [])</div>
<div class="tip" id="fs44">val epsilon : float</div>
<div class="tip" id="fs45">val step : int</div>
<div class="tip" id="fs46">val leapfrog : (float [] -&gt; float [] -&gt; unit)<br /><em><br /><br />&#160;Leapfrog integration</em></div>
<div class="tip" id="fs47">val q : float []</div>
<div class="tip" id="fs48">val p : float []</div>
<div class="tip" id="fs49">val i : int</div>
<div class="tip" id="fs50">val hamiltonian : (float [] -&gt; float [] -&gt; float)<br /><em><br /><br />&#160;Hamiltonian</em></div>
<div class="tip" id="fs51">val potential : float</div>
<div class="tip" id="fs52">val kinetic : float</div>
<div class="tip" id="fs53">val fold : folder:(&#39;State -&gt; &#39;T -&gt; &#39;State) -&gt; state:&#39;State -&gt; array:&#39;T [] -&gt; &#39;State<br /><br />Full name: Microsoft.FSharp.Collections.Array.fold</div>
<div class="tip" id="fs54">val acc : float</div>
<div class="tip" id="fs55">val resampleK : (int -&gt; GeneratorFunction&lt;float []&gt;)<br /><em><br /><br />&#160;resampling of particles</em></div>
<div class="tip" id="fs56">val n : int</div>
<div class="tip" id="fs57">val randomCreate : count:int -&gt; generator:GeneratorFunction&lt;&#39;a&gt; -&gt; GeneratorFunction&lt;&#39;a []&gt;<br /><br />Full name: FsRandom.Array.randomCreate</div>
<div class="tip" id="fs58">module Standard<br /><br />from FsRandom.StatisticsModule</div>
<div class="tip" id="fs59">val normal : GeneratorFunction&lt;float&gt;<br /><br />Full name: FsRandom.StatisticsModule.Standard.normal</div>
<div class="tip" id="fs60">val currentQ : float []</div>
<div class="tip" id="fs61">val copy : array:&#39;T [] -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.copy</div>
<div class="tip" id="fs62">val currentP : float []</div>
<div class="tip" id="fs63">val currentH : float</div>
<div class="tip" id="fs64">val proposedH : float</div>
<div class="tip" id="fs65">val r : float</div>
<div class="tip" id="fs66">val ( [0, 1) ) : GeneratorFunction&lt;float&gt;<br /><br />Full name: FsRandom.RandomNumberGenerator.( [0, 1) )</div>
<div class="tip" id="fs67">val exp : value:&#39;T -&gt; &#39;T (requires member Exp)<br /><br />Full name: Microsoft.FSharp.Core.Operators.exp</div>
<div class="tip" id="fs68">type HiddenSystem =<br />&#160;&#160;| A<br />&#160;&#160;| B<br /><br />Full name: Numerical-examples.HiddenSystem</div>
<div class="tip" id="fs69">union case HiddenSystem.A: HiddenSystem</div>
<div class="tip" id="fs70">union case HiddenSystem.B: HiddenSystem</div>
<div class="tip" id="fs71">val switch : _arg1:HiddenSystem -&gt; HiddenSystem<br /><br />Full name: Numerical-examples.switch</div>
<div class="tip" id="fs72">val observe : correctly:bool -&gt; _arg1:HiddenSystem -&gt; char<br /><br />Full name: Numerical-examples.observe</div>
<div class="tip" id="fs73">val correctly : bool</div>
<div class="tip" id="fs74">val model : theta:float * gamma:float * length:int -&gt; GeneratorFunction&lt;string&gt;<br /><br />Full name: Numerical-examples.model</div>
<div class="tip" id="fs75">val theta : float</div>
<div class="tip" id="fs76">val gamma : float</div>
<div class="tip" id="fs77">val length : int</div>
<div class="tip" id="fs78">val state : HiddenSystem ref</div>
<div class="tip" id="fs79">Multiple items<br />val ref : value:&#39;T -&gt; &#39;T ref<br /><br />Full name: Microsoft.FSharp.Core.Operators.ref<br /><br />--------------------<br />type &#39;T ref = Ref&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.ref&lt;_&gt;</div>
<div class="tip" id="fs80">val builder : System.Text.StringBuilder</div>
<div class="tip" id="fs81">namespace System</div>
<div class="tip" id="fs82">namespace System.Text</div>
<div class="tip" id="fs83">Multiple items<br />type StringBuilder =<br />&#160;&#160;new : unit -&gt; StringBuilder + 5 overloads<br />&#160;&#160;member Append : value:string -&gt; StringBuilder + 18 overloads<br />&#160;&#160;member AppendFormat : format:string * arg0:obj -&gt; StringBuilder + 4 overloads<br />&#160;&#160;member AppendLine : unit -&gt; StringBuilder + 1 overload<br />&#160;&#160;member Capacity : int with get, set<br />&#160;&#160;member Chars : int -&gt; char with get, set<br />&#160;&#160;member Clear : unit -&gt; StringBuilder<br />&#160;&#160;member CopyTo : sourceIndex:int * destination:char[] * destinationIndex:int * count:int -&gt; unit<br />&#160;&#160;member EnsureCapacity : capacity:int -&gt; int<br />&#160;&#160;member Equals : sb:StringBuilder -&gt; bool<br />&#160;&#160;...<br /><br />Full name: System.Text.StringBuilder<br /><br />--------------------<br />System.Text.StringBuilder() : unit<br />System.Text.StringBuilder(capacity: int) : unit<br />System.Text.StringBuilder(value: string) : unit<br />System.Text.StringBuilder(value: string, capacity: int) : unit<br />System.Text.StringBuilder(capacity: int, maxCapacity: int) : unit<br />System.Text.StringBuilder(value: string, startIndex: int, length: int, capacity: int) : unit</div>
<div class="tip" id="fs84">val switchState : bool</div>
<div class="tip" id="fs85">module Utility<br /><br />from FsRandom</div>
<div class="tip" id="fs86">val flipCoin : probability:float -&gt; GeneratorFunction&lt;bool&gt;<br /><br />Full name: FsRandom.Utility.flipCoin</div>
<div class="tip" id="fs87">System.Text.StringBuilder.Append(value: char []) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: obj) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: uint64) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: uint32) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: uint16) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: decimal) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: float) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: float32) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: int64) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.Text.StringBuilder.Append(value: int) : System.Text.StringBuilder<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs88">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>
<div class="tip" id="fs89">System.Text.StringBuilder.ToString() : string<br />System.Text.StringBuilder.ToString(startIndex: int, length: int) : string</div>
<div class="tip" id="fs90">val observed : string<br /><br />Full name: Numerical-examples.observed</div>
<div class="tip" id="fs91">val prior : GeneratorFunction&lt;float&gt;<br /><br />Full name: Numerical-examples.prior</div>
<div class="tip" id="fs92">val gamma : float<br /><br />Full name: Numerical-examples.gamma</div>
<div class="tip" id="fs93">val w : data:string -&gt; int<br /><br />Full name: Numerical-examples.w</div>
<div class="tip" id="fs94">val data : string</div>
<div class="tip" id="fs95">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs96">val windowed : windowSize:int -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T []&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.windowed</div>
<div class="tip" id="fs97">val filter : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.filter</div>
<div class="tip" id="fs98">val c : char []</div>
<div class="tip" id="fs99">val length : source:seq&lt;&#39;T&gt; -&gt; int<br /><br />Full name: Microsoft.FSharp.Collections.Seq.length</div>
<div class="tip" id="fs100">val rho : simulated:string -&gt; int<br /><br />Full name: Numerical-examples.rho</div>
<div class="tip" id="fs101">val simulated : string</div>
<div class="tip" id="fs102">val abs : value:&#39;T -&gt; &#39;T (requires member Abs)<br /><br />Full name: Microsoft.FSharp.Core.Operators.abs</div>
<div class="tip" id="fs103">type SimulationResult =<br />&#160;&#160;| Accept of float<br />&#160;&#160;| Reject<br /><br />Full name: Numerical-examples.SimulationResult</div>
<div class="tip" id="fs104">union case SimulationResult.Accept: float -&gt; SimulationResult</div>
<div class="tip" id="fs105">union case SimulationResult.Reject: SimulationResult</div>
<div class="tip" id="fs106">val simulate : epsilon:int -&gt; GeneratorFunction&lt;SimulationResult&gt;<br /><br />Full name: Numerical-examples.simulate</div>
<div class="tip" id="fs107">val epsilon : int</div>
<div class="tip" id="fs108">Multiple items<br />module String<br /><br />from FsRandom<br /><br />--------------------<br />module String<br /><br />from Microsoft.FSharp.Core</div>
<div class="tip" id="fs109">val length : str:string -&gt; int<br /><br />Full name: Microsoft.FSharp.Core.String.length</div>

        </div>
        <div class="span3">
          <ul class="nav nav-list" id="menu">
            <li class="nav-header">FsRandom</li>
            <li><a href="http://kos59125.github.io/FsRandom/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="https://nuget.org/packages/FsRandom">Get Library via NuGet</a></li>
            <li><a href="https://github.com/kos59125/FsRandom">Source Code on GitHub</a></li>
            <li><a href="https://github.com/kos59125/FsRandom/blob/master/LICENSE">License (BSD 3-clause)</a></li>
            <li><a href="https://github.com/kos59125/FsRandom/blob/master/ChangeLog.md">Change Log</a></li>
            
            <li class="nav-header"><a href="http://kos59125.github.io/FsRandom/documentation.html">Documentation</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/documentation.html#first-random-number">First random number</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/documentation.html#transforming-random-numbers">Transforming random numbers</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/documentation.html#random-number-sequence">Random Number Sequence</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/documentation.html#generator-function">Generator function</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/documentation.html#pseudo-random-number-generator">Pseudo-random number generator</a></li>

            <li class="nav-header"><a href="http://kos59125.github.io/FsRandom/reference/index.html">API Reference</a></li>

            <li class="nav-header"><a href="http://kos59125.github.io/FsRandom/csharp.html">Using From C#</a></li>
            
            <li class="nav-header"><a href="http://kos59125.github.io/FsRandom/numerical-examples.html">Numerical Examples</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/numerical-examples.html#monte-carlo">Estimating pi</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/numerical-examples.html#gibbs-sampler">Gibbs sampler</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/numerical-examples.html#hamiltonian-monte-carlo">Hamiltonian Monte Carlo</a></li>
            <li><a href="http://kos59125.github.io/FsRandom/numerical-examples.html#approximate-bayesian-computation">Approximate Bayesian Computation</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="https://github.com/kos59125/FsRandom"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  </body>
</html>
